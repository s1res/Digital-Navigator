<%- include('../partials/header', { title: '–ê–¥–º–∏–Ω-–ø–∞–Ω–µ–ª—å', page: 'admin' }) %>

  <main>
    <section class="page-header">
      <div class="container">
        <h1>–ê–¥–º–∏–Ω-–ø–∞–Ω–µ–ª—å</h1>
        <p>–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Å–∏—Å—Ç–µ–º–æ–π</p>
      </div>
    </section>

    <section class="admin-section">
      <div class="container">
        <div class="admin-welcome">
          <p>–î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å, <strong><%= typeof user !== 'undefined' && user ? user.username : '' %></strong>!</p>
          <p class="role-info">–í–∞—à–∞ —Ä–æ–ª—å: <span class="role-badge role-<%= typeof user !== 'undefined' && user ? user.role : 'admin' %>"><%= typeof user !== 'undefined' && user ? user.role : 'admin' %></span></p>
        </div>

        <div class="admin-cards">
          <div class="admin-card">
            <h3>üìä –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞</h3>
            <div class="stat-item">
              <span class="stat-label">–í—Å–µ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π:</span>
              <span class="stat-value"><%= typeof stats !== 'undefined' && stats ? stats.total : 0 %></span>
            </div>
            <div class="stat-item">
              <span class="stat-label">–°—É–ø–µ—Ä-–∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–æ–≤:</span>
              <span class="stat-value">
                <%= typeof stats !== 'undefined' && stats && stats.byRole ? (stats.byRole.superadmin || 0) : 0 %>
              </span>
            </div>
            <div class="stat-item">
              <span class="stat-label">–ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–æ–≤:</span>
              <span class="stat-value">
                <%= typeof stats !== 'undefined' && stats && stats.byRole ? (stats.byRole.admin || 0) : 0 %>
              </span>
            </div>
            <div class="stat-item">
              <span class="stat-label">–û–±—ã—á–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π:</span>
              <span class="stat-value">
                <%= typeof stats !== 'undefined' && stats && stats.byRole ? (stats.byRole.user || 0) : 0 %>
              </span>
            </div>
          </div>

          <% if (typeof user !== 'undefined' && user && user.role === 'superadmin') { %>
            <div class="admin-card">
              <h3>üë• –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º–∏</h3>
              <p>–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º–∏ —Å–∏—Å—Ç–µ–º—ã, –∏–∑–º–µ–Ω–µ–Ω–∏–µ —Ä–æ–ª–µ–π</p>
              <a href="/admin/users" class="btn btn-primary">–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º–∏</a>
            </div>
            
            <div class="admin-card">
              <h3>üìù –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∫–æ–Ω—Ç–µ–Ω—Ç–æ–º</h3>
              <p>–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Å–æ–±—ã—Ç–∏—è–º–∏, —Ä—É–∫–æ–≤–æ–¥–∏—Ç–µ–ª—è–º–∏ –æ—Ç–¥–µ–ª–µ–Ω–∏—è –∏ –º–µ—Å—Ç–Ω—ã–º–∏ –ø—Ä–æ–µ–∫—Ç–∞–º–∏</p>
              <a href="/admin/content" class="btn btn-primary">–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∫–æ–Ω—Ç–µ–Ω—Ç–æ–º</a>
            </div>
          <% } %>

          <div class="admin-card">
            <h3>üìß –û–±—Ä–∞—Ç–Ω–∞—è —Å–≤—è–∑—å</h3>
            <p>–ü—Ä–æ—Å–º–æ—Ç—Ä —Å–æ–æ–±—â–µ–Ω–∏–π –∏–∑ –∫–æ–Ω—Ç–∞–∫—Ç–Ω–æ–π —Ñ–æ—Ä–º—ã</p>
            <a href="/admin/feedback" class="btn btn-primary">–û—Ç–∫—Ä—ã—Ç—å</a>
          </div>

          <div class="admin-card">
            <h3>üìÖ –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏ –Ω–∞ –º–µ—Ä–æ–ø—Ä–∏—è—Ç–∏—è</h3>
            <p>–ü—Ä–æ—Å–º–æ—Ç—Ä —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –Ω–∞ –º–µ—Ä–æ–ø—Ä–∏—è—Ç–∏—è</p>
            <a href="/admin/event-registrations" class="btn btn-primary">–û—Ç–∫—Ä—ã—Ç—å</a>
          </div>
        </div>

        <div class="admin-users-preview">
          <h2>–°–ø–∏—Å–æ–∫ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π</h2>
          <div class="users-table">
            <table>
              <thead>
                <tr>
                  <th>ID</th>
                  <th>–ò–º—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è</th>
                  <th>Email</th>
                  <th>–ò–º—è</th>
                  <th>–†–æ–ª—å</th>
                  <th>–î–∞—Ç–∞ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏</th>
                </tr>
              </thead>
              <tbody>
                <% if (typeof users !== 'undefined' && users.length > 0) { %>
                  <% users.forEach(function(u) { %>
                    <tr>
                      <td><%= u.id %></td>
                      <td><%= u.username %></td>
                      <td><%= u.email %></td>
                      <td>
                        <% if (u.first_name || u.last_name) { %>
                          <%= u.first_name || '' %> <%= u.last_name || '' %>
                        <% } else { %>
                          -
                        <% } %>
                      </td>
                      <td><span class="role-badge role-<%= u.role %>"><%= u.role %></span></td>
                      <td><%= u.created_at ? new Date(u.created_at).toLocaleDateString('ru-RU') : '-' %></td>
                    </tr>
                  <% }); %>
                <% } else { %>
                  <tr>
                    <td colspan="6">–ù–µ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π</td>
                  </tr>
                <% } %>
              </tbody>
            </table>
          </div>
        </div>
      </div>
    </section>
  </main>

<%- include('../partials/footer') %>
