<%- include('../partials/header', { title: '–£—á–∞—Å—Ç–∏–µ', page: 'participation' }) %>

  <main>
    <section class="page-header">
      <div class="container">
        <h1>–ú–µ—Å—Ç–Ω–æ–µ –£—á–∞—Å—Ç–∏–µ</h1>
        <p>–°–æ–±—ã—Ç–∏—è, –ø—Ä–æ–µ–∫—Ç—ã –∏ –ª–∏–¥–µ—Ä—ã –Ω–∞—à–µ–≥–æ –æ—Ç–¥–µ–ª–µ–Ω–∏—è</p>
      </div>
    </section>

    <section class="participation-section">
      <div class="container">
        <div class="content-grid">
          <div class="content-block calendar-block">
            <h2>–ö–∞–ª–µ–Ω–¥–∞—Ä—å –°–æ–±—ã—Ç–∏–π</h2>
            <% if (typeof user !== 'undefined' && user && user.role === 'superadmin') { %>
              <div style="margin-bottom: 1rem; text-align: right;">
                <a href="/admin/content" class="btn btn-primary btn-small">–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∫–æ–Ω—Ç–µ–Ω—Ç–æ–º</a>
              </div>
            <% } %>
            <div class="calendar">
              <% if (typeof events !== 'undefined' && events && events.length > 0) { %>
                <% events.forEach(function(event) { %>
                  <% 
                    const eventDate = new Date(event.event_date);
                    const months = ['–Ø–Ω–≤–∞—Ä—å', '–§–µ–≤—Ä–∞–ª—å', '–ú–∞—Ä—Ç', '–ê–ø—Ä–µ–ª—å', '–ú–∞–π', '–ò—é–Ω—å', 
                                   '–ò—é–ª—å', '–ê–≤–≥—É—Å—Ç', '–°–µ–Ω—Ç—è–±—Ä—å', '–û–∫—Ç—è–±—Ä—å', '–ù–æ—è–±—Ä—å', '–î–µ–∫–∞–±—Ä—å'];
                    const day = eventDate.getDate();
                    const month = months[eventDate.getMonth()];
                  %>
                  <div class="event-item">
                    <div class="event-date">
                      <span class="event-day"><%= day %></span>
                      <span class="event-month"><%= month %></span>
                    </div>
                    <div class="event-details">
                      <h4><%= event.title %></h4>
                      <% if (event.description) { %>
                        <p><%= event.description %></p>
                      <% } %>
                      <% if (event.event_time) { %>
                        <span class="event-time">‚è∞ <%= event.event_time %></span>
                      <% } %>
                      <% if (event.location) { %>
                        <span class="event-location">üìç <%= event.location %></span>
                      <% } %>
                      <div class="event-registration-info" style="margin-top: 0.5rem;">
                        <span class="registration-count">üë• –ó–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω–æ: <%= event.registrationCount || 0 %></span>
                      </div>
                      <% if (typeof user !== 'undefined' && user) { %>
                        <div class="event-registration-actions" style="margin-top: 0.75rem;">
                          <% if (event.isRegistered) { %>
                            <button class="btn btn-secondary btn-small event-unregister-btn" data-event-id="<%= event.id %>" style="background-color: #dc3545; border-color: #dc3545;">
                              –û—Ç–º–µ–Ω–∏—Ç—å —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—é
                            </button>
                          <% } else { %>
                            <button class="btn btn-primary btn-small event-register-btn" data-event-id="<%= event.id %>">
                              –ó–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞—Ç—å—Å—è
                            </button>
                          <% } %>
                        </div>
                      <% } else { %>
                        <div style="margin-top: 0.75rem;">
                          <a href="/login" class="btn btn-primary btn-small">–í–æ–π–¥–∏—Ç–µ, —á—Ç–æ–±—ã –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞—Ç—å—Å—è</a>
                        </div>
                      <% } %>
                    </div>
                  </div>
                <% }); %>
              <% } else { %>
                <p style="text-align: center; color: var(--text-light); padding: 2rem;">
                  –°–æ–±—ã—Ç–∏—è –ø–æ–∫–∞ –Ω–µ –¥–æ–±–∞–≤–ª–µ–Ω—ã
                </p>
              <% } %>
            </div>
          </div>

          <div class="content-block">
            <h2>–ú–µ—Å—Ç–Ω—ã–µ –ü—Ä–æ–µ–∫—Ç—ã</h2>
            <% if (typeof user !== 'undefined' && user && user.role === 'superadmin') { %>
              <div style="margin-bottom: 1rem; text-align: right;">
                <a href="/admin/content" class="btn btn-primary btn-small">–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∫–æ–Ω—Ç–µ–Ω—Ç–æ–º</a>
              </div>
            <% } %>
            <div class="projects-list">
              <% if (typeof projects !== 'undefined' && projects && projects.length > 0) { %>
                <% projects.forEach(function(project) { %>
                  <div class="project-card">
                    <h4><%= project.icon ? project.icon + ' ' : '' %><%= project.title %></h4>
                    <p><%= project.description %></p>
                  </div>
                <% }); %>
              <% } else { %>
                <p style="text-align: center; color: var(--text-light); padding: 2rem;">
                  –ü—Ä–æ–µ–∫—Ç—ã –ø–æ–∫–∞ –Ω–µ –¥–æ–±–∞–≤–ª–µ–Ω—ã
                </p>
              <% } %>
            </div>
          </div>
        </div>

        <div class="leaders-section">
          <h2>–†—É–∫–æ–≤–æ–¥–∏—Ç–µ–ª–∏ –û—Ç–¥–µ–ª–µ–Ω–∏—è</h2>
          <div class="leaders-grid">
            <% if (typeof leaders !== 'undefined' && leaders && leaders.length > 0) { %>
              <% leaders.forEach(function(leader) { %>
                <div class="leader-card">
                  <div class="leader-avatar"><%= leader.avatar || 'üë§' %></div>
                  <h3><%= leader.name %></h3>
                  <p class="leader-role"><%= leader.role %></p>
                  <% if (leader.bio) { %>
                    <p class="leader-bio"><%= leader.bio %></p>
                  <% } %>
                </div>
              <% }); %>
            <% } else { %>
              <p style="text-align: center; color: var(--text-light); padding: 2rem; grid-column: 1 / -1;">
                –†—É–∫–æ–≤–æ–¥–∏—Ç–µ–ª–∏ –ø–æ–∫–∞ –Ω–µ –¥–æ–±–∞–≤–ª–µ–Ω—ã
              </p>
            <% } %>
          </div>
        </div>
      </div>
    </section>
  </main>

<%- include('../partials/footer') %>
