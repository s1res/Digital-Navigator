<%- include('../partials/header', { title: '–†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏ –Ω–∞ –º–µ—Ä–æ–ø—Ä–∏—è—Ç–∏–µ', page: 'admin-event-registration-details' }) %>

  <main>
    <section class="page-header">
      <div class="container">
        <h1>–†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏ –Ω–∞ –º–µ—Ä–æ–ø—Ä–∏—è—Ç–∏–µ</h1>
        <p>–°–ø–∏—Å–æ–∫ –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π</p>
      </div>
    </section>

    <section class="admin-section">
      <div class="container">
        <div style="margin-bottom: 2rem;">
          <a href="/admin/event-registrations" class="btn btn-secondary">‚Üê –ù–∞–∑–∞–¥ –∫ —Å–ø–∏—Å–∫—É –º–µ—Ä–æ–ø—Ä–∏—è—Ç–∏–π</a>
        </div>

        <% if (typeof event !== 'undefined' && event) { %>
          <div class="event-details-card" style="background: var(--card-bg); padding: 1.5rem; border-radius: 8px; margin-bottom: 2rem; border: 1px solid var(--border-color);">
            <h2 style="margin-top: 0; color: var(--primary-color);"><%= event.title %></h2>
            <% if (event.description) { %>
              <p style="color: var(--text-light); margin-bottom: 1rem;"><%= event.description %></p>
            <% } %>
            <div style="display: flex; flex-wrap: wrap; gap: 1.5rem; font-size: 0.95rem;">
              <% 
                const eventDate = new Date(event.event_date);
                const formattedDate = eventDate.toLocaleDateString('ru-RU', { 
                  day: 'numeric', 
                  month: 'long', 
                  year: 'numeric' 
                });
              %>
              <span><strong>üìÖ –î–∞—Ç–∞:</strong> <%= formattedDate %></span>
              <% if (event.event_time) { %>
                <span><strong>‚è∞ –í—Ä–µ–º—è:</strong> <%= event.event_time %></span>
              <% } %>
              <% if (event.location) { %>
                <span><strong>üìç –ú–µ—Å—Ç–æ:</strong> <%= event.location %></span>
              <% } %>
              <span><strong>üë• –ó–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω–æ:</strong> <%= registrations.length %> —á–µ–ª–æ–≤–µ–∫</span>
            </div>
          </div>

          <div class="registrations-list-section">
            <h3 style="margin-bottom: 1rem;">–ó–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏</h3>
            
            <% if (typeof registrations !== 'undefined' && registrations && registrations.length > 0) { %>
              <div class="registrations-table">
                <table>
                  <thead>
                    <tr>
                      <th>ID</th>
                      <th>–ò–º—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è</th>
                      <th>Email</th>
                      <th>–ò–º—è</th>
                      <th>–¢–µ–ª–µ—Ñ–æ–Ω</th>
                      <th>–î–∞—Ç–∞ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏</th>
                    </tr>
                  </thead>
                  <tbody>
                    <% registrations.forEach(function(registration) { %>
                      <tr>
                        <td><%= registration.user_id %></td>
                        <td><strong><%= registration.username %></strong></td>
                        <td><%= registration.email %></td>
                        <td>
                          <% if (registration.first_name || registration.last_name) { %>
                            <%= registration.first_name || '' %> <%= registration.last_name || '' %>
                          <% } else { %>
                            -
                          <% } %>
                        </td>
                        <td><%= registration.phone || '-' %></td>
                        <td>
                          <%= new Date(registration.created_at).toLocaleDateString('ru-RU', { 
                            day: 'numeric', 
                            month: 'long', 
                            year: 'numeric',
                            hour: '2-digit',
                            minute: '2-digit'
                          }) %>
                        </td>
                      </tr>
                    <% }); %>
                  </tbody>
                </table>
              </div>

              <div style="margin-top: 1.5rem; padding: 1rem; background: var(--card-bg); border-radius: 8px; border: 1px solid var(--border-color);">
                <p style="margin: 0; color: var(--text-light);">
                  <strong>–í—Å–µ–≥–æ –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω–æ:</strong> <span style="color: var(--primary-color); font-weight: bold; font-size: 1.1em;"><%= registrations.length %></span> —á–µ–ª–æ–≤–µ–∫
                </p>
              </div>
            <% } else { %>
              <div style="text-align: center; padding: 2rem; color: var(--text-light); background: var(--card-bg); border-radius: 8px; border: 1px solid var(--border-color);">
                <p style="font-size: 1.1em; margin-bottom: 0.5rem;">–ù–∞ —ç—Ç–æ –º–µ—Ä–æ–ø—Ä–∏—è—Ç–∏–µ –ø–æ–∫–∞ –Ω–∏–∫—Ç–æ –Ω–µ –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–ª—Å—è</p>
                <p style="margin: 0;">–†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏ –ø–æ—è–≤—è—Ç—Å—è –∑–¥–µ—Å—å, –∫–æ–≥–¥–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä—É—é—Ç—Å—è –Ω–∞ –º–µ—Ä–æ–ø—Ä–∏—è—Ç–∏–µ.</p>
              </div>
            <% } %>
          </div>
        <% } else { %>
          <div class="error-message">
            <p>‚ùå –ú–µ—Ä–æ–ø—Ä–∏—è—Ç–∏–µ –Ω–µ –Ω–∞–π–¥–µ–Ω–æ</p>
          </div>
        <% } %>
      </div>
    </section>
  </main>

<%- include('../partials/footer') %>
